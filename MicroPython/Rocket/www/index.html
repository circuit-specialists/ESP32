<!DOCTYPE html>
<html>

<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <title>Rocket Launch</title>
</head>

<body>
    <h1>Data</h1>
    <table id="data" border="1">
    </table>

    <canvas id="altitude_graph" width="400" height="400"></canvas>
    <canvas id="acceleration_graph" width="400" height="400"></canvas>
    <canvas id="pressure_graph" width="400" height="400"></canvas>
    <canvas id="gps_graph" width="400" height="400"></canvas>
</body>

<script>
    setInterval(newRequest(), 1000);

    function newRequest() {
        if (typeof(EventSource) !== 'undefined') {
            const source = new EventSource('http://' + window.location.hostname + '/sensordata');
            source.onmessage = function(e) {
                var table_html = "" +
                    "<tr><th> Starting Altitude </th><th> %s ft</th></tr>" +
                    "<tr><th> Current Altitude </th><th> %s ft</th></tr>" +
                    "<tr><th> Max Altitude </th><th> %s ft</th></tr>" +
                    "<tr><th> Current Acceleration </th><th> %s m/s</th></tr>" +
                    "<tr><th> Max Acceleration </th><th> %s m/s</th></tr>" +
                    "<tr><th> Pressure </th><th> %s hPa</th></tr>" +
                    "<tr><th> Latitude </th><th> %s %s </th></tr>" +
                    "<tr><th> Longitude </th><th> %s %s </th></tr>" +
                    "<tr><th> Lateral Speed </th><th> %s m/s</th></tr>" +
                    "<tr><th> UTC </th><th> %s </th></tr>";
                var table_data = e.data.split(',');
                for (var i in table_data) {
                    table_html = table_html.replace("%s", table_data[i]);
                    table_html = table_html.replace("'", '');
                }
                table_html = table_html.replace("[", '');
                table_html = table_html.replace("]", '');

                document.getElementById("data").innerHTML = table_html;
            };
        }
    }
</script>

</html>